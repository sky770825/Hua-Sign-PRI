# ⏰ Insforge 速率限制恢復指南

## 🔍 速率限制持續時間

### 一般情況

**速率限制通常是暫時的**，持續時間取決於：

1. **請求頻率**：
   - 輕微超限：通常 1-5 分鐘
   - 嚴重超限：可能需要 10-30 分鐘

2. **Insforge 的速率限制策略**：
   - 通常使用滑動窗口或令牌桶算法
   - 限制會隨著時間逐漸恢復

3. **您的使用情況**：
   - 如果停止發送請求，限制會更快解除
   - 如果繼續發送請求，限制可能會延長

## ⏱️ 預估恢復時間

### 標準恢復時間

| 情況 | 預估恢復時間 |
|------|-------------|
| 輕微超限 | 1-5 分鐘 |
| 中等超限 | 5-15 分鐘 |
| 嚴重超限 | 15-30 分鐘 |
| 持續超限 | 30-60 分鐘 |

### 我們的系統設置

- **自動刷新間隔**：60 秒（已優化）
- **速率限制檢測**：自動暫停背景刷新
- **自動恢復**：5 分鐘後嘗試恢復

## 🔄 如何檢查 Insforge 是否恢復正常

### 方法 1：查看瀏覽器控制台

1. 按 `F12` 打開開發者工具
2. 查看 "Console" 標籤
3. 如果看到：
   - ✅ 沒有 "Too many requests" 錯誤 → 已恢復
   - ❌ 仍有 "Too many requests" 錯誤 → 仍在限制中

### 方法 2：測試簡單請求

1. 訪問後台管理頁面
2. 嘗試執行一個簡單操作（例如：查看會員列表）
3. 如果操作成功 → 已恢復
4. 如果顯示速率限制錯誤 → 仍在限制中

### 方法 3：檢查 Network 標籤

1. 按 `F12` 打開開發者工具
2. 切換到 "Network" 標籤
3. 執行一個操作（例如：刷新頁面）
4. 查看 API 請求的狀態碼：
   - ✅ **200 OK** → 已恢復
   - ❌ **429 Too Many Requests** → 仍在限制中

### 方法 4：查看系統日誌

如果背景刷新已恢復，表示系統認為限制已解除：
- 檢查瀏覽器控制台是否有 "Resuming background refresh" 訊息
- 如果有，表示系統已自動恢復

## 🚀 加速恢復的方法

### 1. 停止發送請求

- **關閉後台頁面**：暫時關閉後台管理頁面
- **等待 1-2 分鐘**：讓速率限制自然解除
- **重新打開頁面**：再試一次

### 2. 減少請求頻率

- **手動刷新**：不要頻繁手動刷新頁面
- **單一操作**：一次只執行一個操作
- **等待完成**：等待一個操作完成後再執行下一個

### 3. 檢查其他來源

- **多個標籤頁**：確認沒有打開多個後台頁面
- **其他應用**：確認沒有其他應用在使用同一個 Insforge 後端
- **自動化腳本**：確認沒有自動化腳本在發送請求

## 📊 系統自動恢復機制

### 我們的系統設置

```typescript
// 檢測到速率限制時
if (errorMessage.includes('Too many requests')) {
  isPaused = true  // 暫停背景刷新
  
  // 5 分鐘後自動恢復
  setTimeout(() => {
    isPaused = false
    console.log('Resuming background refresh after rate limit cooldown')
  }, 5 * 60 * 1000)  // 5 分鐘
}
```

### 恢復流程

1. **檢測速率限制** → 自動暫停背景刷新
2. **等待 5 分鐘** → 系統自動等待
3. **嘗試恢復** → 自動恢復背景刷新
4. **如果仍有限制** → 再次暫停，等待更長時間

## ⚠️ 如果長時間無法恢復

### 檢查清單

1. **確認 Insforge 服務狀態**：
   - 訪問 Insforge Dashboard
   - 檢查服務是否正常運行
   - 查看是否有維護通知

2. **檢查配額使用**：
   - 查看 Insforge Dashboard 的配額使用情況
   - 確認沒有超出配額限制

3. **檢查 API Key**：
   - 確認 API Key 仍然有效
   - 確認沒有被撤銷或禁用

4. **聯繫 Insforge 支援**：
   - 如果問題持續超過 1 小時
   - 聯繫 Insforge 技術支援
   - 提供錯誤訊息和時間戳

## 💡 最佳實踐

### 避免觸發速率限制

1. **使用優化後的刷新間隔**：
   - 系統已設置為 60 秒刷新一次
   - 不要手動修改為更短的間隔

2. **避免同時操作**：
   - 一次只執行一個操作
   - 等待操作完成後再執行下一個

3. **監控請求頻率**：
   - 注意瀏覽器控制台的錯誤訊息
   - 如果看到速率限制警告，立即停止操作

### 遇到速率限制時

1. **立即停止操作**：
   - 不要繼續嘗試上傳或操作
   - 關閉不必要的標籤頁

2. **等待恢復**：
   - 等待 1-2 分鐘
   - 系統會自動嘗試恢復

3. **檢查狀態**：
   - 使用上述方法檢查是否已恢復
   - 確認恢復後再繼續操作

## 📝 實用時間表

### 典型恢復時間表

```
時間     | 狀態           | 建議操作
---------|---------------|------------------
0 分鐘   | 觸發速率限制   | 停止所有操作
1-2 分鐘 | 等待恢復       | 不要發送請求
3-5 分鐘 | 可能已恢復     | 測試簡單操作
5 分鐘   | 系統自動恢復   | 背景刷新恢復
10 分鐘  | 應該已恢復     | 可以正常使用
```

### 如果 30 分鐘後仍無法恢復

1. **檢查 Insforge Dashboard**
2. **查看服務狀態**
3. **聯繫技術支援**

## 🔧 技術細節

### Insforge 速率限制機制

- **類型**：通常使用令牌桶或滑動窗口算法
- **限制**：基於 IP 地址和時間窗口
- **恢復**：隨著時間逐漸恢復可用配額

### 我們的優化

- **請求頻率**：從每 30 秒改為每 60 秒
- **請求數量**：從 8+ 個減少到 6-8 個
- **智能檢測**：自動檢測並暫停
- **自動恢復**：5 分鐘後自動嘗試恢復

---

## 📌 總結

**一般恢復時間**：1-5 分鐘（輕微超限）到 15-30 分鐘（嚴重超限）

**快速檢查方法**：
1. 查看瀏覽器控制台是否有錯誤
2. 測試一個簡單操作
3. 檢查 Network 標籤的狀態碼

**加速恢復**：
- 停止發送請求
- 關閉不必要的標籤頁
- 等待 1-2 分鐘

**如果長時間無法恢復**：
- 檢查 Insforge 服務狀態
- 檢查配額使用情況
- 聯繫技術支援

---

**最後更新**：2025-01-06  
**版本**：v1.0.0

